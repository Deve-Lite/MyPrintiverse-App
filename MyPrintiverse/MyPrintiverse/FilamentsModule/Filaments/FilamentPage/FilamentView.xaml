<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="MyPrintiverse.FilamentsModule.Filaments.FilamentPage.FilamentView"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml" 
             xmlns:model="clr-namespace:MyPrintiverse.FilamentsModule.Spools"
             xmlns:viewmodel="clr-namespace:MyPrintiverse.FilamentsModule.Filaments.FilamentPage"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             Title="FilamentView">

    <StackLayout VerticalOptions="StartAndExpand">

        <Frame Grid.Row="0" 
                   Style="{StaticResource BaseFrame}" 
                   Padding="15"
                   VerticalOptions="Center">

            <StackLayout>

                <Label Style="{StaticResource TitleOswald}" 
                           FontAttributes="Bold" 
                           Text="{Binding Item.Brand}"/>

                <Label Style="{StaticResource SmallRaleway}"
                           Text="{Binding Item.TypeId,StringFormat='Filament Type: {0}', Converter={StaticResource TypeIdToTypeConverter}}"/>

                <Label Style="{StaticResource SmallRaleway}"
                           Text="{Binding Item.Color,StringFormat='Color: {0}'}"/>

                <Label Style="{StaticResource SmallRaleway}"
                           Text="{Binding Item.Diameter,StringFormat='Diameter: {0:0.00} mm'}"/>

                <Label Style="{StaticResource SmallRaleway}"
                           Text="{Binding Item.NozzleTemperature,StringFormat='Nozzle Temperature: {0} °C'}"/>

                <Label Style="{StaticResource SmallRaleway}" 
                           Text="{Binding Item.BedTemperature,StringFormat='Bed Temperature: {0} °C'}"/>

                <Label Style="{StaticResource SmallRaleway}"
                           Text="{Binding Item.CoolingRate,StringFormat='Cooling Rate: {0} %'}"/>

                <Label Style="{StaticResource SmallRaleway}" 
                           Text="{Binding Item.Rating,StringFormat='Rating: {0}'}"/>

                <Frame BackgroundColor="{Binding Item.ColorHex, Converter={StaticResource StringToColorConverter}}" HorizontalOptions="FillAndExpand" CornerRadius="4" HeightRequest="15" Margin="0,4,0,0" />

                <Label Style="{StaticResource SmallRaleway}" 
                           Text="{Binding Item.Description}"/>

            </StackLayout>
        </Frame >


        <RefreshView Grid.Row="2" 
                     Style="{StaticResource BaseStyle}" 
                     HorizontalOptions="CenterAndExpand" 
                     Margin="20" 
                     VerticalOptions="FillAndExpand">
            <ScrollView>
                <StackLayout>
                    <Frame Grid.Row="1" Style="{StaticResource BaseFrame}" HeightRequest="40" HorizontalOptions="FillAndExpand" VerticalOptions="Start" Margin="0">
                        <Label Style="{StaticResource LargeOswald}" 
                       HorizontalOptions="Center"
                       VerticalOptions="Center" 
                       Text="Avaliable Spools" 
                       FontAttributes="Bold"/>
                    </Frame>

                    <CollectionView Style="{StaticResource BaseCollectionView}"
                                Header="{Binding .}">

                        <CollectionView.ItemsLayout>
                            <LinearItemsLayout Orientation="Horizontal"/>
                        </CollectionView.ItemsLayout>

                        <CollectionView.HeaderTemplate>
                            <DataTemplate>
                                <Frame Style="{StaticResource BaseFrame}" 
                                   Margin="0,10,10,10"  
                                   Padding="10" 
                                   HeightRequest="190" >

                                    <Frame.GestureRecognizers>
                                        <TapGestureRecognizer Command="{Binding AddItemCommand,Source={RelativeSource AncestorType={x:Type viewmodel:FilamentViewModel}}}"
                                                          CommandParameter="{Binding .}"/>
                                    </Frame.GestureRecognizers>

                                    <StackLayout>
                                        <Label Text="add new spool"/>
                                    </StackLayout>
                                </Frame>
                            </DataTemplate>
                        </CollectionView.HeaderTemplate>

                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="model:Spool">
                                <StackLayout VerticalOptions="Center">
                                    <Frame Style="{StaticResource BaseFrame}" 
                                       
                                   Margin="0,10,10,10"  
                                   Padding="10" 
                                   HeightRequest="90" >

                                        <StackLayout>
                                            <Label Text="{Binding FilamentId}"/>
                                        </StackLayout>
                                    </Frame>
                                </StackLayout>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>

                    </CollectionView>

                    <Frame Grid.Row="3" Style="{StaticResource BaseFrame}" HeightRequest="40"  Margin="0">
                        <Label Style="{StaticResource LargeOswald}"
                       HorizontalOptions="Center" 
                       VerticalOptions="Center" 
                       Text="Finished Spools"
                       FontAttributes="Bold"/>
                    </Frame>

                    <CollectionView Style="{StaticResource BaseCollectionView}"
                                Header="{Binding .}">

                        <CollectionView.ItemsLayout>
                            <LinearItemsLayout Orientation="Horizontal"/>
                        </CollectionView.ItemsLayout>

                        <CollectionView.HeaderTemplate>
                            <DataTemplate>
                                <Frame Style="{StaticResource BaseFrame}" 
                                   Margin="0,10,10,10"  
                                   Padding="10" 
                                   HeightRequest="190" >

                                    <Frame.GestureRecognizers>
                                        <TapGestureRecognizer Command="{Binding AddItemCommand,Source={RelativeSource AncestorType={x:Type viewmodel:FilamentViewModel}}}"
                                                          CommandParameter="{Binding .}"/>
                                    </Frame.GestureRecognizers>

                                    <StackLayout>
                                        <Label Text="add new spool"/>
                                    </StackLayout>
                                </Frame>
                            </DataTemplate>
                        </CollectionView.HeaderTemplate>

                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="model:Spool">
                                <StackLayout VerticalOptions="Center">
                                    <Frame Style="{StaticResource BaseFrame}" 
                                       
                                   Margin="0,10,10,10"  
                                   Padding="10" 
                                   HeightRequest="190" >

                                        <StackLayout>
                                            <Label Text="{Binding FilamentId}"/>
                                        </StackLayout>
                                    </Frame>
                                </StackLayout>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>

                    </CollectionView>

                </StackLayout>
            </ScrollView>
        </RefreshView>
    </StackLayout>
</ContentPage>
